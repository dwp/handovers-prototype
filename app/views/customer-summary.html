{% extends "layout.html" %}

{% block content %}

<main id="content" role="main">
    <div class="main-content">
        {% include "includes/handovers_summary_nav.html" %}
        {% include "includes/error-summary.html" %}
        {% include "includes/message-banner.html" %}
        <h1 class="heading-large">View summary details for {{ customer.firstName }} {{ customer.lastName }}</h1>

        <div>
            <h3 class="heading-medium">Customer details</h3>
        <div class="grid-row">
            <div class="column-half">
                <div>
                    <table>
                        <tr>
                            <td>National insurance number</td>
                            <td>{{ customer.nino }}</td>
                        </tr>
                        <tr>
                            <td>Postcode</td>
                            <td>{{ customer.postcode }}</td>
                        </tr>
                        <tr>
                            <td>Job Centre</td>
                            <td>{{ customerOfficeDetails.officeName }}</td>
                        </tr>
                        <tr>
                            <td>Preferred contact number</td>
                            <td>{{ customer.preferredContactNumber }}</td>
                        </tr>
                        <tr>
                            <td>Email address</td>
                            <td>{{ customer.emailAddress }}</td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="column-half">
                <div>
                    <table>
                        <tr>
                            <td>Date of birth</td>
                            <td>{{ customer.birthDay }} {{ customer.birthMonth }} {{ customer.birthYear }}</td>
                        </tr>
                        <tr>
                            <td>Welsh speaker ?</td>
                            <td>{{ customer.welshSpeaker }}</td>
                        </tr>
                        <tr>
                            <td>Translator required ?</td>
                            <td>{% if customer.translator === 'Yes' %}{{ customer.language }}{% else %}No{% endif %}</td>
                        </tr>
                        <tr>
                            <td>Approved representative name</td>
                            <td>{% if customer.approvedRepName === '' %}N/A{% else %}{{ customer.approvedRepName }}{% endif %}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <br>
        <div class="grid-row">
            <div class="column-full">
                <h3 class="heading-medium">Handovers</h3>
                <div>
                    <table>
                        <thead>
                        <tr>
                            <th scope="col"><span>Benefit type</span></th>
                            <th scope="col"><span>Handover type</span></th>
                            <th scope="col"><span>Handover reason</span></th>
                            <th scope="col"><span>Date/time raised</span></th>
                            <th scope="col"><span>Status</span></th>
                            <th scope="col"></th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for handover in handoversList %}
                        <tr>
                            <td>{{handover.handoverTextDetails.benefitName}}</td>
                            <td>{{handover.handoverTextDetails.handoverType}}</td>
                            <td>{{handover.handoverTextDetails.handoverReason}}</td>
                            <td>{{handover.dateAndTimeRaisedForDisplay.day}} {{handover.dateAndTimeRaisedForDisplay.month}} {{handover.dateAndTimeRaisedForDisplay.year}}</td>
                            <td>{{handover.status}}</td>
                            <td>{{handoverUpdateLink(handover)}}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <br>
        <br>
        <div class="grid-row">
            <div class="column-half">
                <div class="form-group">
                    <a href="/customer/edit?nino={{ customer.nino }}" class="button">Amend customer details</a>
                </div>
            </div>
            <div class="column-half">
                <div class="form-group">
                    <a href="/handover/create?nino={{ customer.nino }}" class="button">Create handover</a>
                </div>
            </div>
        </div>

        <div class="grid-row">
            <div class="column-half">
                <div class="form-group">
                    <a href="/index">Back to index page</a>
                </div>
            </div>
        </div>
        </div>
    </div>
</main>

<script src="/public/javascripts/vendor/jquery-1.11.3.min.js"></script>

<script>
    $('table').DataTable({
        paging: false,
        info: false,
        filter: false,
        order: [[ 4, "asc" ]],
    })
</script>

{% endblock %}

{% macro handoverUpdateLink(handover) %}
{% set queryString = '?id=' + handover.id %}
<a href="/handover/edit{{queryString}}">View/Update</a>
{% endmacro %}
